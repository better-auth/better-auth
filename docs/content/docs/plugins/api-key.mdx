---
title: API Key
description: API Key plugin for Better Auth.
---

The API Key plugin allows you to create and manage API keys for your application. It provides a way to authenticate and authorize API requests by verifying API keys.


## Installation

<Steps>
    <Step>
        ### Add Plugin to the server

        ```ts title="auth.ts"
        import { betterAuth } from "better-auth"
        import { apiKey } from "better-auth/plugins"

        const auth = betterAuth({
            plugins: [ // [!code highlight]
                apiKey() // [!code highlight]
            ] // [!code highlight]
        })
        ```
    </Step>
    <Step>
        ### Migrate the database

        Run the migration or generate the schema to add the necessary fields and tables to the database.

        <Tabs items={["migrate", "generate"]}>
            <Tab value="migrate">
            ```bash
            npx @better-auth/cli migrate
            ```
            </Tab>
            <Tab value="generate">
            ```bash
            npx @better-auth/cli generate
            ```
            </Tab>
        </Tabs>
        See the [Schema](#schema) section to add the fields manually.
    </Step>
    <Step>
        ### Add the client plugin

        ```ts title="auth-client.ts"
        import { createAuthClient } from "better-auth/client"
        import { apiKeyClient } from "better-auth/client/plugins"

        const authClient = createAuthClient({
            plugins: [ // [!code highlight]
                apiKeyClient() // [!code highlight]
            ] // [!code highlight]
        })
        ```
    </Step>

</Steps>

## Usage

### Create an API key

To create an API key, you can use the `apiKey.create` function provided by the client. The `apiKey.create` function takes an object with the following properties:

- `identifier`: The identifier of the API key.
- `withoutOwner`: Whether to create the API key without an owner. (Default `false`)
- `remaining`: The number of requests remaining. (Default `null`)
- `prefix`: The prefix of the API key. (Default `undefined`)
- `length`: The length of the API key. (Default `64`)
- `expires`: The expiration date of the API key in Unix timestamp format. (Default `null`)
- `enabled`: Whether the API key is enabled or not. (Default `true`)

<Callout>
  If you're creating an API key without an owner, you must provide the `expires`
  or `remaining` properties.
</Callout>

```ts
const data = await authClient.apiKey.create({
  identifier: "test",
  withoutOwner: true,
  remaining: 10,
  prefix: "test",
  length: 64,
  expires: 1679012000,
  enabled: true,
});
```

### Verifying an API key

```ts
const { valid } = await client.apiKey.verify({
  key: "my-api-key",
});
```

### Updating an API key

You can pass an API key ID to the `apiKey.update` function to update information on the API key.

Properties that can be updated:

- `name`: The name of the API key.
- `remaining`: The number of requests remaining.
- `expires`: The expiration date of the API key in Unix timestamp format.
- `enabled`: Whether the API key is enabled or not.

```ts
await client.apiKey.update({
  keyId: "my-key-id",
  name: "new-name",
  remaining: 10,
  expires: 1679012000,
  enabled: true,
});
```

### Revoking an API key

```ts
await client.apiKey.revoke({
  keyId: "my-key-id",
});
```

### Rerolling an API key

You can pass an API key ID to the `apiKey.reroll` function to reroll the API key.

Additional properties can allow you to configure the rerolled API key:

- `prefix`: The prefix of the API key. (Default `undefined`)
- `length`: The length of the API key. (Default `64`)

```ts
await client.apiKey.reroll({
  keyId: "my-key-id",
  prefix: "test",
  length: 64,
});
```

### Listing API keys

You can pass an identifier to the `apiKey.list` function to list API keys.

```ts
const data = await authClient.apiKey.list({
  query: {
    identifier: "test",
  },
});
```

### Getting information on an API key

You can pass an API key ID to the `apiKey.get` function to get information on the API key including the key itself.

If an API key was created without an owner, then you cannot get it's information as it requires authorization to get the information.

```ts
const data = await authClient.apiKey.get({
  query: {
    keyId: "my-key-id",
  },
});
```

## Schema

Table: `apiKeys`

<DatabaseTable
  fields={[
    {
      name: "id",
      type: "string",
      description: "The ID of the api key",
      isUnique: true,
      isPrimaryKey: true,
    },
    {
      name: "createdAt",
      type: "Date",
      description: "The date and time the API key was created",
    },
    {
      name: "updatedAt",
      type: "Date",
      description: "The date and time the API key was updated",
    },
    {
      name: "lastVerifiedAt",
      type: "Date",
      description: "The date and time the API key was last verified",
      isOptional: true,
    },
    {
      name: "remaining",
      type: "number",
      description: "The number of requests remaining",
      isOptional: true,
    },
    {
      name: "key",
      type: "string",
      description: "The API key itself",
    },
    {
      name: "identifier",
      type: "string",
      description: "The identifier of the API key",
    },
    {
      name: "ownerId",
      type: "string",
      description: "The ID of the user who owns the API key",
      isForeignKey: true,
      isOptional: true,
    },
    {
      name: "expires",
      type: "number",
      description:
        "The expiration date of the API key in Unix timestamp format",
      isOptional: true,
    },
    {
      name: "name",
      type: "string",
      description: "The name of the API key",
      isOptional: true,
    },
    {
      name: "isEnabled",
      type: "boolean",
      description: "Whether the API key is enabled",
    },
  ]}
/>

## Server only functions

### Delete all expired API keys

To delete all expired API keys, you can use the `apiKey.deleteAllExpiredApiKeys` function provided by the server auth instance.
This function will delete all API keys that have an expiration date and are expired.

<Callout>
    We automatically delete expired API keys every time any apiKey plugin functions were called, however they are rate-limited to a 10 second cooldown each call.
</Callout>

```ts
await auth.api.apiKey.deleteAllExpiredApiKeys();
```

