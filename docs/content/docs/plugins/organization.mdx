---
title: Organization Plugin
description: Organization Plugin
---

Organizations Plugin offer a versatile and scalable approach to controlling user access and permissions within your application. By leveraging organizations, you can allocate distinct roles and permissions to individuals, streamlining the management of projects, team coordination, and partnership facilitation.

## Quick setup

<Steps>
    <Step>
        ### Add the plugin to your auth config

        ```ts title="auth.ts" twoslash
        import { betterAuth } from "better-auth"
        import { organization } from "better-auth/plugins"

        export const auth = await betterAuth({
            database: {
                provider: "sqlite",
                url: "./db.sqlite",
            },
            plugins: [ // [!code highlight]
                organization() // [!code highlight]
            ] // [!code highlight]
        })
        ```
    </Step>
    <Step>
        ### Migarate database
        Once you've added the plugin, you need to migrate your database to add the necessary tables and fields. You can do this by running the following command:

        ```bash
        npx better-auth migrate
        ```
    </Step>
    <Step>
        ### Add the client plugin
        
        ```ts title="client.ts" twoslash
        import { createAuthClient } from "better-auth/client"
        import { organizationClient } from "better-auth/client/plugins"

        const client = createAuthClient({
            authPlugins: [ // [!code highlight]
                organizationClient() // [!code highlight]
            ] // [!code highlight]
        })
        ```
    </Step>
    <Step>
        ### Create an Organization
        
        this will create an organization with the name `My Organization` and slug `my-org`. The user who creates the organization will be the `owner` of the organization by default.

        ```ts title="client.ts" twoslash
        import { createAuthClient } from "better-auth/client"
        import { organizationClient } from "better-auth/client/plugins"

        const client = createAuthClient({
            authPlugins: [ // [!code highlight]
                organizationClient() // [!code highlight]
            ] // [!code highlight]
        })
        // ---cut---
        const data = await client.organization.create({
                name: "My Organization",
                slug: "my-org"
        })
        ```
    </Step>

    <Step>
        ### List Organizations

        To list all user's organization on the client you can use `useListOrganizations` hook or for svelte you can use `client.$listOrganizations`.

        ```tsx title="client.tsx"
        import { createAuthClient } from "better-auth/react"
        import { organizationClient } from "better-auth/client/plugins"

        const client = createAuthClient({
            authPlugins: [
                organizationClient()
            ] 
        })
        function App(){
            const organizations = client.useListOrganizations()
            return (
                <div>
                    {
                        organizations.map(org => <p>{org.name}</p>)
                    }
                </div>
            )
        } 
        ```
    </Step>

    <Step>
        ### Active Organization

        #### Set Active Organization
        
        Active organization is the organization that the user is currently working on. You can set the active organization by calling the `organization.setActive` function. It'll set the active organization for the user both on the client state and the session on the server.
        
        ```ts title="client.ts" twoslash
        import { createAuthClient } from "better-auth/client"
        import { organizationClient } from "better-auth/client/plugins"

        const client = createAuthClient({
            authPlugins: [ // [!code highlight]
                organizationClient() // [!code highlight]
            ] // [!code highlight]
        })
        // ---cut---
        
        client.organization.setActive("organization-id")
        ```
        <Callout type="info">
           `setActive` updates the active organization reactively. Ensure it's used according to your framework's rules for reactive calls. For React, call it within a component and follow the rules of hooks.
        </Callout>

        #### Get Active Organization
        To retrieve the active organization for the user, you can call the `useActiveOrganization` hook. It returns the active organization for the user.

        ```tsx title="client.tsx" 
        import { createAuthClient } from "better-auth/react"
        import { organizationClient } from "better-auth/client/plugins"

        const client = createAuthClient({
            authPlugins: [
                organizationClient()
            ] 
        })
        function App(){
            const activeOrganization = client.useActiveOrganization()
            return (
                <div>
                    {
                        activeOrganization ? <p>{activeOrganization.name}</p> : null
                    }
                </div>
            )
        } 
        ```
        The above example should be roughly similar for all frameworks except for the svelte. For svelte, you can need to use `client.$activeOrganization`. instead. And make sure to call it with `$` to make it reactive.
        ```svelte title="page.svelte"
        <script lang="ts">
            import { createAuthClient } from "better-auth/svelte"
            import { organizationClient } from "better-auth/client/plugins"

            const client = createAuthClient({
                authPlugins: [
                    organizationClient()
                ] 
            })
            const activeOrganization = client.$activeOrganization
        </script>

        <div>
            {#if $activeOrganization}
                <p>{$activeOrganization.name}</p>
            {/if}
        </div>
        ```
    </Step>
    <Step>
        ### Invite Users to Organization

        #### Send Invitation

        For member invitation to work we first need to provider `sendInvitationEmail` to the `better-auth` instance. This function is responsible for sending the invitation email to the user. The function takes an object with the following properties:
        - `email`: The email address of the user.
        - `invitation`: The invitation object that contains the organization id and the role of the user in the organization and the invitation id which serve as a token for the user to accept the invitation.

        ```ts title="auth.ts" twoslash

        import { betterAuth } from "better-auth"
        import { organization } from "better-auth/plugins"

        export const auth = await betterAuth({
            database: {
                provider: "sqlite",
                url: "./db.sqlite",
            },
            plugins: [
                organization({
                    sendInvitationEmail: async (invitation, email) => {
                        const url = `http://example.com/accept-invitation?token={invitation.id}`
                        // send email
                    }
                })
            ]
        })
        ````

        To invite users to an organization, you can use the `invite` function provided by the client. The `invite` function takes an object with the following properties:

        - `email`: The email address of the user.
        - `role`: The role of the user in the organization. It can be `admin`, `member`, or `guest`.
        - `organizationId`: The id of the organization. this is optional by default it will use the active organization.

        ```ts title="client.ts" twoslash
         import { createAuthClient } from "better-auth/client"
        import { organizationClient } from "better-auth/client/plugins"

        const client = createAuthClient({
            authPlugins: [ // [!code highlight]
                organizationClient() // [!code highlight]
            ] // [!code highlight]
        })
        // ---cut---
        const data = await client.organization.inviteMember({
            email: "test@email.com",
            role: "admin",
        })
        ```

        #### Get Invitation

        When a user clicks the invitation link, use setInvitationId with the invitation ID. Then, use the useInvitation hook to fetch the invitation object. If the token is valid, the hook returns the invitation object; if not, it returns null.

        ```tsx title="client.tsx"

        import { createAuthClient } from "better-auth/react"

        const client = createAuthClient({
            authPlugins: [
                organizationClient()
            ] 
        })
        function App(){
            useEffect(() => {
                client.setInvitationId(
                    urlParams.get("token")
                )
            }, [])
            const invitation = client.useInvitation()
            return (
                <div>
                    {
                        invitation ? <p>{invitation.email}</p> : null
                    }
                </div>
            )
        }
        ```
        #### Update Invitation Status
        
        To update the status of invitation you can use the `acceptInvitation`, `cancelInvitation`, `rejectInvitation` functions provided by the client. The functions take the invitation id as an argument.

        ```ts title="client.ts" twoslash
                import { createAuthClient } from "better-auth/client"
        import { organizationClient } from "better-auth/client/plugins"

        const client = createAuthClient({
            authPlugins: [ // [!code highlight]
                organizationClient() // [!code highlight]
            ] // [!code highlight]
        })
        // ---cut---
        const data = await client.organization.acceptInvitation({
            invitationId: "invitation-id"
        })
        ```
      <Callout>
      To accept or cancel an invitation, the invited user must sign in using the email address specified in the invitation. Upon accepting the invitation, the user will be added to the organization with the role outlined in the invitation.
      </Callout> 
    </Step>

    <Step>
        ### Remove and Update Memeber
        To remove or update memebrs you can use `organization.removeMember` or `organization.updateMember`.
    </Step>
    <Step>
        ðŸŽ‰ Congrats you have setup organization sucessfully.
    </Step>
</Steps>

## Access Control

The plugin providers a very flexible access control system. You can control the access of the user based on the role they have in the organization. You can define your own set of permissions based on the role of the user.

### Roles

`owner`: The user who created the organization by default. The owner has full control over the organization and can perform any action.

`admin`: Users with the admin role have full control over the organization except for deleting the organization or changing the owner.

`member`: Users with the member role have limited control over the organization. They can create projects, invite users, and manage projects they have created.

### Permissons

By defualt there are 3 resources and they have 2 to 3 actions.

**organization**: 

    `update` `delete`

**member**: 

    `create` `update` `delete`

**invitation**: 
    
    `create` `cancel`

The owner have full control over all the resources and actions. The admin have full control over all the resources except for deleting the organization or changing the owner. The member have no control over any of those action other than reading the data.

### Custom Permissions

the plugin providers easy way to define your own set of permission for each role.

**Terminologies**

`resource`: The resource for which you want to define the permission. For example, `project`, `task`, `comment`, etc.

`action`: The action that the user can perform on the resource. For example, `create`, `read`, `update`, `delete`.

`statement`: The statement that defines the permission for the role. The statement is an object with the resource as the key and an array of actions as the value.

`role`: The role for which you want to define the permission. For example, `admin`, `member`, `owner`. 

<Callout type="warn">
    Currently the plugin only supports those 3 pre-defined roles. You can't add your own role.
</Callout>

```ts title="permissions.ts" twoslash
import { createAccessControl } from "better-auth/plugins/access";

const statement = {
	project: ["create", "share", "update", "delete"],
};
const ac = createAccessControl(statement);

const member = ac.newRole({
	project: ["create"],
});
const admin = ac.newRole({
    project: ["create", "update"],
});
const owner = ac.newRole({
    project: ["create", "update", "delete"],
});
```

<Callout type="info">
We need to share the permission with both the client and the server. You can define the permission in a separate file and import it in both the client and the server.
</Callout>

**Add permissions to the serever**

```ts title="auth.ts"
import { betterAuth } from "better-auth"
import { organization } from "better-auth/plugins"
import { ac, member, owner, admin } from "./permissions" // [!code highlight]

export const auth = await betterAuth({
    database: {
        provider: "sqlite",
        url: "./db.sqlite",
    },
    plugins: [
        organization({
            ac, // [!code highlight]
            roles: { // [!code highlight]
                member, // [!code highlight]
                admin, // [!code highlight]
                owner, // [!code highlight]
            } // [!code highlight]
        })
    ]
})
```


## Options

### Server

**allowUserToCreateOrganization**: `boolean` | `((user: User) => Promise<boolean> | boolean)` - Allow users to create organizations. By default, it's `true`. You can set it to `false` to disable users from creating organizations. You can also provide a function that returns a boolean value to determine if the user can create an organization. For emxaple you can allow them based on their subscription plan.
```ts title="auth.ts" 
import { betterAuth } from "better-auth"
import { organization } from "better-auth/plugins"

const auth = await betterAuth({
    database: {
        provider: "sqlite",
        url: "./db.sqlite",
    },
    plugins: [
        organization({
            allowUserToCreateOrganization: (user) => {
                const subscription = await getSubscription(user.id)
                return subscription.plan === "pro"
            }
        })
    ]
})
```

**creatorRole**: `admin | owner` - The role of the user who creates the organization. By default, it's `owner`. You can set it to `admin`.

**membershipLimit**: `number` - The maximum number of members allowed in an organization. By default, it's `100`. You can set it to any number you want.

**sendInvitationEmail**: `async (invitation: Invitation, email: string) => Promise<void>` - A function that sends an invitation email to the user. The function takes an invitation object and the email address of the user as arguments. You can use this function to send an email with an invitation link to the user. The invitation object contains the organization id, the role of the user in the organization, and the invitation id which serves as a token for the user to accept the invitation.

```ts title="auth.ts"

import { betterAuth } from "better-auth"
import { organization } from "better-auth/plugins"

export const auth = await betterAuth({
    database: {
        provider: "sqlite",
        url: "./db.sqlite",
    },
    plugins: [
        organization({
            sendInvitationEmail: async (invitation, email) => {
                const url = `http://example.com/accept-invitation?token={invitation.id}`
                // send email
            }
        })
    ]
})
```