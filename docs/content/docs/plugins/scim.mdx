---
title: System for Cross-domain Identity Management (SCIM)
description: Integrate SCIM with your application.
---

System for Cross-domain Identity Management ([SCIM](https://simplecloud.info/#Specification))
makes managing identities in multi-domain scenarios easier
to support via a standardized protocol.

## Installation

<Steps>
    <Step>
        ### Install the plugin

        ```bash
        npm install @better-auth/scim
        ```
    </Step>
    <Step>
        ### Add Plugin to the server

        ```ts title="auth.ts"
        import { betterAuth } from "better-auth"
        import { scim } from "@better-auth/scim";

        const auth = betterAuth({
            plugins: [ // [!code highlight]
                scim() // [!code highlight]
            ] // [!code highlight]
        })
        ```
    </Step>
    <Step>
        ### Enable SCIM provisioning

        Supported plugins will have the ability to automatically provision a SCIM integration:

        > **Note**: At this time, only the SSO plugin supports SCIM provisioning

        ```ts title="auth.ts"
        import { betterAuth } from "better-auth"
        import { sso } from "@better-auth/sso";

        const auth = betterAuth({
            plugins: [
                sso({
                    enableSCIMProvisioning: true // [!code highlight]
                })
            ]
        })
        ```

        Upon service registration (e.g `auth.api.registerSSOProvider()`), this will automatically
        register a SCIM token associated to the provider.
        Your identity provider may use it to authenticate against your SCIM server.

        Additionally, if your provider is associated to an `organization`,
        the SCIM integration will also be restricted to that organization.

    </Step>
    <Step>
        ### Enable HTTP methods

        SCIM requires additional HTTP methods to be supported by your server:

        ```ts title="api/auth/[...all]/route.ts"
        import { auth } from "@/lib/auth";
        import { toNextJsHandler } from "better-auth/next-js";

        export const { POST, GET, PUT, PATCH, DELETE } = toNextJsHandler(auth); // [!code highlight]
        ```
    </Step>
    <Step>
        ### Migrate the database

        Run the migration or generate the schema to add the necessary fields and tables to the database.

        <Tabs items={["migrate", "generate"]}>
            <Tab value="migrate">
            ```bash
            npx @better-auth/cli migrate
            ```
            </Tab>
            <Tab value="generate">
            ```bash
            npx @better-auth/cli generate
            ```
            </Tab>
        </Tabs>
        See the [Schema](#schema) section to add the fields manually.
    </Step>
</Steps>

## Usage

Upon registration, this plugin will expose compliant [SCIM 2.0](https://simplecloud.info/#Specification) server.
The following subset of the specification is currently supported:

#### SCIM endpoints

- GET `/api/auth/scim/v2/Users` - Get all provisioned users
- GET `/api/auth/scim/v2/Users/:userId` - Get a provisioned user info
- POST `/api/auth/scim/v2/Users` - Provision a new user
- PUT `/api/auth/scim/v2/Users/:userId` - Update an existing provisioned user
- PATCH `/api/auth/scim/v2/Users/:userId` - Partially update an existing provisioned user

Generally, this server is meant to be consumed by a third-party (your identity provider), which will require:

- SCIM base url: This should be the fully qualified URL to be SCIM server (e.g `http://your-app.com/api/auth/scim/v2`)
- SCIM bearer token: This will be automatically generated by supported plugins (via the `enableSCIMProvisioning` option or similar)

#### SCIM attribute mapping

By default, the SCIM provisioning will automatically map the following fields:

- `user.email`: User primary email or the first available email if there is not a primary one
- `user.name`: Derived from `name` (`name.formatted` or `name.givenName` + `name.familyName`) and fallbacks to the user primary email
- `account.providerId`: Provider associated to the `SCIM` token
- `account.accountId`: Defaults to `externalId` and fallbacks to `userName`
- `member.organizationId`: Organization associated to the provider

## Schema

The plugin requires additional fields in the `scimProvider` table to store the provider's configuration.

<DatabaseTable
    fields={[
        {
            name: "id", type: "string", description: "A database identifier", isRequired: true, isPrimaryKey: true,
        },
        { name: "providerId", type: "string", description: "The provider ID. Used to identify a provider and to generate a redirect URL.", isRequired: true, isUnique: true },
        { name: "scimToken", type: "string", description: "The SCIM bearer token. Used by your identity provider to authenticate against your server", isRequired: true, isUnique: true },
        { name: "organizationId", type: "string", description: "The organization Id. If provider is linked to an organization.", isRequired: false },
    ]}
/>

